# Карта проекта AI-Bot

## Общая структура проекта

Проект представляет собой веб-приложение, построенное на Laravel (бэкенд) и Vue.js (фронтенд), с использованием Tailwind CSS для стилизации.

### Основные директории:

- **app/** - основная логика приложения (контроллеры, модели, провайдеры)
- **resources/** - фронтенд-ресурсы (Vue компоненты, стили, шаблоны)
- **routes/** - определение маршрутов API и веб-интерфейса
- **database/** - миграции и сидеры базы данных
- **config/** - конфигурационные файлы
- **public/** - публично доступные файлы
- **storage/** - хранилище файлов
- **bootstrap/** - файлы для запуска приложения
- **tests/** - тесты

## Бэкенд (Laravel)

### Модели данных

- **User** - пользователи системы (включая администраторов)
- **Service** - сервисы, предоставляемые системой
- **ServiceTranslation** - переводы для сервисов
- **Proxy** - прокси-серверы
- **Subscription** - подписки пользователей
- **Option** - опции системы
- **Page** - страницы сайта
- **PageTranslation** - переводы для страниц

### Контроллеры

#### Пользовательские контроллеры:

- **ServiceController** - управление сервисами для пользователей
- **PageController** - отображение страниц
- **CartController** - управление корзиной и подписками
- **OptionController** - получение опций системы
- **Auth/AuthController** - аутентификация пользователей

#### Административные контроллеры:

- **Admin/AdminController** - управление администраторами
- **Admin/DashboardController** - панель управления
- **Admin/PageController** - управление страницами
- **Admin/ProfileController** - управление профилем администратора
- **Admin/ProxyController** - управление прокси-серверами
- **Admin/ServiceController** - управление сервисами
- **Admin/SettingController** - управление настройками
- **Admin/SubscriptionController** - управление подписками
- **Admin/UserController** - управление пользователями

### Маршруты (Routes)

#### Веб-маршруты (web.php):

- **Административная панель**:
  - `/admin/login` - страница входа для администраторов
  - `/admin` - панель управления
  - `/admin/users` - управление пользователями
  - `/admin/subscriptions` - управление подписками
  - `/admin/proxies` - управление прокси
  - `/admin/services` - управление сервисами
  - `/admin/pages` - управление страницами
  - `/admin/settings` - управление настройками
  - `/admin/admins` - управление администраторами (только для главного админа)
  - `/admin/profile` - профиль администратора
  - `/admin/logout` - выход из системы

- **Пользовательский интерфейс**:
  - `/` - главная страница
  - `/service/{service}` - запуск сервиса (требуется аутентификация)
  - `/{any}` - обработка всех остальных маршрутов (Vue Router)

#### API-маршруты (api.php):

- **Аутентификация**:
  - `POST /api/register` - регистрация пользователя
  - `POST /api/login` - вход в систему
  - `POST /api/logout` - выход из системы
  - `GET /api/user` - получение данных пользователя
  - `POST /api/user` - обновление данных пользователя

- **Данные**:
  - `GET /api/services` - получение списка сервисов
  - `GET /api/pages` - получение списка страниц
  - `GET /api/options` - получение опций системы
  - `POST /api/cart` - добавление в корзину
  - `POST /api/cancel-subscription` - отмена подписки

## Фронтенд (Vue.js)

### Основные компоненты:

- **app.js** - точка входа приложения
- **router.js** - настройка маршрутизации

### Страницы:

- **Home.vue** - главная страница
- **Page.vue** - динамическая страница контента
- **Checkout.vue** - страница оформления заказа
- **NotFound.vue** - страница 404
- **account/Profile.vue** - профиль пользователя
- **account/Subscriptions.vue** - подписки пользователя
- **auth/LoginPage.vue** - страница входа
- **auth/RegisterPage.vue** - страница регистрации

### Хранилища состояний (Stores):

- **auth.ts** - аутентификация и данные пользователя
- **cart.js** - корзина покупок
- **options.js** - опции системы
- **pages.js** - страницы сайта
- **services.js** - доступные сервисы

## База данных

### Основные таблицы:

- **users** - пользователи системы
- **services** - сервисы
- **service_translations** - переводы для сервисов
- **proxies** - прокси-серверы
- **subscriptions** - подписки пользователей
- **options** - опции системы
- **pages** - страницы сайта
- **page_translations** - переводы для страниц

## Руководство по запуску проекта

### Локальная разработка

1. **Клонирование репозитория**:

   ```bash
   git clone [URL_репозитория]
   cd ai-bot
   ```

2. **Установка зависимостей**:

   ```bash
   composer install
   npm install
   ```

3. **Настройка окружения**:
   - Скопировать файл `.env.example` в `.env`
   - Настроить подключение к базе данных в файле `.env`

   ```bash
   cp .env.example .env
   php artisan key:generate
   ```

4. **Миграция базы данных**:

   ```bash
   php artisan migrate
   ```

5. **Запуск серверов разработки**:

   ```bash
   # Запуск PHP-сервера
   php artisan serve

   # В отдельном терминале запуск Vite для фронтенда
   npm run dev
   ```

6. **Доступ к приложению**:
   - Фронтенд: http://localhost:8000
   - Админ-панель: http://localhost:8000/admin

### Деплой на production-сервер

1. **Подготовка сервера**:
   - Установить PHP 8.1+, Composer, Node.js, MySQL/PostgreSQL
   - Настроить веб-сервер (Nginx/Apache)

2. **Клонирование репозитория**:

   ```bash
   git clone [URL_репозитория] /path/to/project
   cd /path/to/project
   ```

3. **Установка зависимостей**:

   ```bash
   composer install --no-dev --optimize-autoloader
   npm install
   ```

4. **Настройка окружения**:
   - Создать файл `.env` с production-настройками
   - Установить APP_ENV=production и APP_DEBUG=false
   - Настроить подключение к базе данных

   ```bash
   php artisan key:generate
   ```

5. **Сборка фронтенда**:

   ```bash
   npm run build
   ```

6. **Миграция базы данных**:

   ```bash
   php artisan migrate --force
   ```

7. **Настройка прав доступа**:

   ```bash
   chmod -R 775 storage bootstrap/cache
   chown -R www-data:www-data storage bootstrap/cache
   ```

8. **Настройка кэширования**:
   ```bash
   php artisan config:cache
   php artisan route:cache
   php artisan view:cache
   ```

### Обновление на production-сервере

1. **Получение последних изменений**:

   ```bash
   cd /path/to/project
   git pull
   ```

2. **Обновление зависимостей**:

   ```bash
   composer install --no-dev --optimize-autoloader
   npm install
   ```

3. **Миграция базы данных** (если есть новые миграции):

   ```bash
   php artisan migrate --force
   ```

4. **Сборка фронтенда**:

   ```bash
   npm run build
   ```

5. **Обновление кэша**:

   ```bash
   php artisan config:cache
   php artisan route:cache
   php artisan view:cache
   ```

6. **Перезапуск очередей** (если используются):
   ```bash
   php artisan queue:restart
   ```

## Основные функции системы

### Пользовательская часть:

- Регистрация и авторизация пользователей
- Просмотр доступных сервисов
- Оформление подписки на сервисы
- Управление профилем пользователя
- Просмотр активных подписок и их отмена

### Административная часть:

- Управление пользователями (просмотр, блокировка)
- Управление администраторами
- Управление сервисами (создание, редактирование, удаление)
- Управление прокси-серверами
- Управление страницами сайта
- Настройка системы
- Управление подписками пользователей

## Технический стек

- **Бэкенд**: Laravel 10.x, PHP 8.1+
- **Фронтенд**: Vue.js 3.x, Vuetify, Tailwind CSS
- **База данных**: MySQL/PostgreSQL
- **Сборка фронтенда**: Vite
- **Аутентификация**: Laravel Sanctum
- **Локализация**: Vue I18n
- **Управление состоянием**: Pinia
- **Админ-панель**: AdminLTE
