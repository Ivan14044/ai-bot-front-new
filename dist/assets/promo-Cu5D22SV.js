import{P as a,Q as p}from"./index-D06XNq7w.js";const d=a("promo",{state:()=>({code:"",loading:!1,error:"",result:null,lastAppliedAt:null}),actions:{async apply(c){var t,r,o,i;const e=(c||"").trim();if(!e){this.error="";return}this.loading=!0,this.error="",this.result=null;try{const{data:s}=await p.post("/promocodes/validate",{code:e});(s==null?void 0:s.type)==="discount"?(this.code=e,this.result={type:"discount",discount_percent:Number(s.discount_percent||0)}):(s==null?void 0:s.type)==="free_access"?(this.code=e,this.result={type:"free_access",services:Array.isArray(s.services)?s.services:[]}):this.error=(s==null?void 0:s.message)||"Invalid promocode",this.lastAppliedAt=Date.now()}catch(s){const l=(r=(t=s==null?void 0:s.response)==null?void 0:t.data)==null?void 0:r.status,n=(i=(o=s==null?void 0:s.response)==null?void 0:o.data)==null?void 0:i.message;this.error=n||(l?"Promocode ".concat(l):"Invalid promocode")}finally{this.loading=!1}},clear(){this.code="",this.error="",this.result=null,this.lastAppliedAt=null}},persist:!0});export{d as usePromoStore};
