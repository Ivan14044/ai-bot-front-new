import{U as se,d as G,C as N,B as oe,q as re,e as f,o as v,F as ae,y as ne,f as e,I as w,g as T,h as n,t as i,n as q,j,_ as I,r as Z,D as ie,s as k,a0 as ke,u as we,V as Ae,b as $e,a1 as Ce,p as Me,c as Se,i as U,z as D,k as J,v as K,w as L,a2 as je,H as Fe,$ as Te,a3 as Q,Q as X}from"./index-D06XNq7w.js";import{u as le}from"./alert-CmjDD-k8.js";import{usePromoStore as ce}from"./promo-Cu5D22SV.js";import{_ as Pe}from"./BackLink.vue_vue_type_script_setup_true_lang-DhsFgQHw.js";import{C as ee}from"./check-D_0_rWxA.js";/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=se("trash",[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=se("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function Be(m,g="ru"){switch(g){case"ru":{const u=m%10,y=m%100;return u===1&&y!==11?"".concat(m," день"):u>=2&&u<=4&&(y<10||y>=20)?"".concat(m," дня"):"".concat(m," дней")}case"uk":{const u=m%10,y=m%100;return u===1&&y!==11?"".concat(m," день"):u>=2&&u<=4&&(y<10||y>=20)?"".concat(m," дні"):"".concat(m," днів")}case"en":return m===1?"".concat(m," day"):"".concat(m," days");case"es":return m===1?"".concat(m," día"):"".concat(m," días");case"zh":return"".concat(m," 天");default:return"".concat(m," days")}}const Ve={class:"flex flex-col gap-6 w-full"},Ue=["disabled","onClick"],Le={class:"flex items-start gap-4 text-dark dark:text-white"},Ze=["src","alt"],Ge={class:"flex-1 space-y-2"},Ne={class:"text-lg sm:text-xl"},Ie={class:"text-sm"},ze=["innerHTML"],He={class:"mt-4 grid grid-cols-1 text-dark dark:text-white sm:grid-cols-2 gap-4"},We=["onClick"],Oe={class:"flex justify-between items-start xl:items-center"},Re={class:"xl:flex xl:items-center xl:gap-2"},Ye={class:"text-xs px-2 py-1 bg-orange-400 !text-gray-950 rounded-lg"},Ee={class:"text-right xl:flex xl:items-center"},qe={class:"text-lg font-bold"},Je={class:"text-xs text-dark dark:text-white xl:ml-2"},Ke=["onClick"],Qe={class:"flex justify-between items-start xl:items-center"},Xe={class:"xl:flex xl:items-center xl:gap-2"},et={class:"text-xs px-2 py-1 bg-green-400 !text-gray-950 rounded-lg"},tt={class:"text-right xl:flex xl:items-center"},st={class:"text-lg font-bold"},ot={class:"text-xs text-dark dark:text-white xl:ml-2"},rt={key:0,class:"absolute -top-3 -left-3 bg-green-500 text-white text-xs px-2 py-1 rounded-md shadow"},at=G({__name:"ServiceList",setup(m){const g=N(),u=ce(),y=oe(),{locale:$,t:h}=re(),{showConfirm:c}=le(),A=new Intl.NumberFormat("en-US",{style:"currency",currency:y.options.currency,minimumFractionDigits:0,maximumFractionDigits:2}),b=(d,_)=>{var o,C,M,F;return(F=(M=(o=d.translations[$.value])==null?void 0:o[_])!=null?M:(C=d.translations.en)==null?void 0:C[_])!=null?F:null},p=(d,_)=>{const o=g.getSubscriptionType(d)===_;return _==="trial"?["plan-card cursor-pointer rounded-lg p-3 relative border-2",o?"border-orange-400 bg-orange-400/10":"border-transparent glass-card hover:border-orange-400/50"]:["plan-card cursor-pointer rounded-lg p-3 relative border-2",o?"border-green-400 bg-green-400/10":"border-transparent glass-card hover:border-green-400/50"]},r=async d=>{(await c({title:h("cart.confirm.remove_single.title"),text:h("cart.confirm.remove_single.text"),confirmText:h("cart.confirm.remove_single.confirm"),cancelText:h("cart.confirm.remove_single.cancel")})).isConfirmed&&g.removeFromCart(d)},x=d=>g.isFree(d)&&!!u.code&&!!u.result&&u.result.type==="free_access";return(d,_)=>(v(),f("div",Ve,[(v(!0),f(ae,null,ne(n(g).items,o=>(v(),f("div",{key:o.id,class:"service-card transition-all duration-300 glass-card rounded-3xl p-4 sm:p-6 relative"},[e("button",{type:"button",class:w(["absolute top-4 right-4 w-9 h-9 rounded-full glass-button flex items-center justify-center transition-colors duration-200 hover:bg-red-500 text-dark dark:text-white hover:text-white",x(o.id)?"opacity-50 cursor-not-allowed hover:bg-transparent hover:text-current":""]),disabled:x(o.id),onClick:C=>!x(o.id)&&r(o.id)},[T(n(De),{class:"w-4"})],10,Ue),e("div",Le,[e("img",{src:o.logo,alt:"".concat(b(o,"name")," Logo"),class:"w-16 h-16 sm:w-20 sm:h-20 flex-shrink-0 object-contain"},null,8,Ze),e("div",Ge,[e("h3",Ne,i(b(o,"name")),1),e("p",Ie,i(b(o,"subtitle")),1),e("p",{class:"text-sm mt-1",innerHTML:b(o,"short_description_checkout")},null,8,ze)])]),e("div",He,[e("div",{class:w(["plan-card rounded-lg p-3 relative border-2",[p(o.id,"trial"),n(g).isFree(o.id)?"opacity-50 pointer-events-none cursor-not-allowed":"cursor-pointer"]]),onClick:C=>!n(g).isFree(o.id)&&n(g).setSubscriptionType(o.id,"trial")},[e("div",Oe,[e("div",Re,[_[0]||(_[0]=e("div",{class:"text-lg"},"Trial",-1)),e("div",Ye,i(d.$t("checkout.trial_badge")),1)]),e("div",Ee,[e("div",qe,i(n(g).isFree(o.id)?n(A).format(0):n(A).format(o.trial_amount)),1),e("div",Je,[_[1]||(_[1]=e("span",{class:"hidden xl:!inline-flex mr-1"}," / ",-1)),q(" "+i(n(Be)(n(y).options.trial_days,n($))),1)])])])],10,We),e("div",{class:w(["plan-card cursor-pointer rounded-lg p-3 relative border-2",p(o.id,"premium")]),onClick:C=>!n(g).isFree(o.id)&&n(g).setSubscriptionType(o.id,"premium")},[e("div",Qe,[e("div",Xe,[_[2]||(_[2]=e("div",{class:"text-lg"},"Premium",-1)),e("div",et,i(d.$t("checkout.premium_badge")),1)]),e("div",tt,[e("div",st,i(n(g).isFree(o.id)?n(A).format(0):n(A).format(o.amount)),1),e("div",ot,[_[3]||(_[3]=e("span",{class:"hidden xl:!inline-flex mr-1"}," / ",-1)),q(i(d.$t("perMonth")),1)])])]),n(g).isFree(o.id)?(v(),f("div",rt,i(d.$t("checkout.free_via_promocode",{days:n(g).promoFreeDays[o.id]||0})),1)):j("",!0)],10,Ke)])]))),128))]))}}),nt=I(at,[["__scopeId","data-v-7b8345f0"]]),it="data:image/png;base64,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",lt="/ai-bot-front-new/assets/Google_Pay_Logo.svg-h4Y4vlz0.png",ct="/ai-bot-front-new/assets/VISA-logo-Bv4jiMXy.png",dt="/ai-bot-front-new/assets/mastercard-logo-BRj9UBQ9.png",ut="/ai-bot-front-new/assets/Bitcoin.svg-CDsAdeWD.png",pt="/ai-bot-front-new/assets/Ethereum_logo_translucent-BMe2KU8-.png",mt="/ai-bot-front-new/assets/tether-logo-v-ijRJKZ.png",ht={class:"space-y-3 text-dark dark:text-white"},vt={class:"flex items-center gap-3 w-100"},gt={class:"flex-1"},_t={class:"font-medium"},bt={class:"text-xs"},yt={class:"mt-2 flex items-center gap-2"},xt={class:"icon-pill",title:"Apple Pay"},ft=["src"],kt={class:"icon-pill",title:"Google Pay"},wt=["src"],At={class:"icon-pill",title:"Visa"},$t=["src"],Ct={class:"icon-pill",title:"Mastercard"},Mt=["src"],St={class:"ml-auto"},jt={class:"flex items-center gap-3 w-100"},Ft={class:"flex-1"},Tt={class:"font-medium"},Pt={class:"text-xs"},Dt={class:"mt-2 flex items-center gap-2"},Bt={class:"icon-pill",title:"Bitcoin"},Vt=["src"],Ut={class:"icon-pill",title:"Ethereum"},Lt=["src"],Zt={class:"icon-pill",title:"Tether"},Gt=["src"],Nt={class:"ml-auto"},It=G({__name:"PaymentList",props:{modelValue:{},disabled:{type:Boolean}},emits:["update:modelValue"],setup(m,{emit:g}){const u=m,y=g,$=Z(u.modelValue),h=N();ie(()=>u.modelValue,p=>{$.value=p});const c=k(()=>h.items.some(p=>h.getSubscriptionType(p.id)==="trial")),A=p=>{u.disabled||($.value=p,y("update:modelValue",p))},b=p=>["payment-method cursor-pointer rounded-lg p-4 border-2 flex items-center gap-3",$.value===p?"border-blue-400 bg-blue-400/10":"border-transparent glass-card hover:border-blue-400/50",c.value&&p==="crypto"?"opacity-50 pointer-events-none":"",u.disabled?"opacity-50 pointer-events-none":""];return(p,r)=>(v(),f("div",ht,[e("div",{class:w(b("card")),onClick:r[0]||(r[0]=x=>A("card"))},[e("div",vt,[r[2]||(r[2]=ke('<div class="w-10 h-10 rounded flex items-center justify-center" data-v-08745cea><svg width="28" height="20" viewBox="0 0 28 20" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-08745cea><rect x="0.5" y="1" width="27" height="18" rx="3" stroke="currentColor" stroke-opacity="0.9" data-v-08745cea></rect><rect x="3" y="6" width="8" height="2" rx="1" fill="currentColor" fill-opacity="0.9" data-v-08745cea></rect><rect x="3" y="10" width="5" height="2" rx="1" fill="currentColor" fill-opacity="0.9" data-v-08745cea></rect></svg></div>',1)),e("div",gt,[e("div",_t,i(p.$t("checkout.credit_card")),1),e("div",bt,i(p.$t("checkout.credit_card_placeholder")),1),e("div",yt,[e("div",xt,[e("img",{src:n(it),alt:"Apple Pay",class:"h-3 object-contain object-center"},null,8,ft)]),e("div",kt,[e("img",{src:n(lt),alt:"google pay",class:"h-3 object-contain object-center"},null,8,wt)]),e("div",At,[e("img",{src:n(ct),alt:"Visa",class:"h-4 object-contain object-center"},null,8,$t)]),e("div",Ct,[e("img",{src:n(dt),alt:"mastercard",class:"h-4 object-contain object-center"},null,8,Mt)])])]),e("div",St,[e("div",{class:w(["w-4 h-4 rounded-full border-2 transition-all duration-300",$.value==="card"?"border-blue-400 bg-blue-400":"border-gray-800 dark:border-gray-100"])},null,2)])])],2),e("div",{class:w(b("crypto")),onClick:r[1]||(r[1]=x=>A("crypto"))},[e("div",jt,[r[3]||(r[3]=e("div",{class:"w-10 h-10 rounded flex items-center justify-center"},[e("span",{class:"text-xl"},"₿")],-1)),e("div",Ft,[e("div",Tt,i(p.$t("checkout.crypto")),1),e("div",Pt,i(p.$t("checkout.crypto_placeholder")),1),e("div",Dt,[e("div",Bt,[e("img",{src:n(ut),alt:"bitcoin",class:"h-4 object-contain object-center"},null,8,Vt)]),e("div",Ut,[e("img",{src:n(pt),alt:"ethereum",class:"h-4 object-contain object-center"},null,8,Lt)]),e("div",Zt,[e("img",{src:n(mt),alt:"tether",class:"h-4 object-contain object-center"},null,8,Gt)])])]),e("div",Nt,[e("div",{class:w(["w-4 h-4 rounded-full border-2 transition-all duration-300",$.value==="crypto"?"border-blue-400 bg-blue-400":"border-gray-800 dark:border-gray-100"])},null,2)])])],2)]))}}),zt=I(It,[["__scopeId","data-v-08745cea"]]),Ht={class:"max-w-7xl mx-auto px-4 py-16 sm:px-6 lg:px-8 relative z-1"},Wt={key:0,class:"mx-auto grid gap-8 lg:grid-cols-[minmax(0,1fr)_24rem]"},Ot={class:"flex items-center justify-between mt-6 mb-2 lg:col-span-2"},Rt={class:"text-2xl font-medium md:text-4xl md:font-light text-dark dark:text-white"},Yt={class:"min-w-0"},Et={class:"w-full lg:max-w-sm text-dark dark:text-white font-normal space-y-6"},qt={class:"glass-card rounded-3xl p-6 relative overflow-hidden"},Jt={class:"space-y-4"},Kt={class:"space-y-2"},Qt={class:"flex justify-between items-center"},Xt={class:"font-normal"},es={key:0,class:"flex justify-between items-center text-sm"},ts={key:1,class:"flex justify-between items-center text-sm"},ss={key:2,class:"flex justify-between items-center"},os={class:"font-normal"},rs={class:"font-normal"},as={class:"space-y-2"},ns={class:"flex items-stretch gap-0"},is=["placeholder","disabled"],ls=["disabled","aria-label"],cs={class:"mt-3 rounded-lg overflow-hidden glass-card"},ds={class:"px-3 py-2"},us={class:"flex items-center justify-between gap-3"},ps={class:"text-left text-xs text-dark dark:text-white leading-snug"},ms={class:"font-medium"},hs={key:0,class:"mt-3 rounded-lg overflow-hidden glass-card"},vs={class:"px-3 py-2"},gs={class:"text-xs text-dark dark:text-white font-medium mb-1"},_s={class:"font-medium"},bs={class:"ml-2"},ys={key:0,class:"mt-3 rounded-lg overflow-hidden glass-card"},xs={class:"px-3 py-2"},fs={class:"flex items-center justify-between gap-3"},ks={class:"text-left text-xs text-dark dark:text-white leading-snug"},ws={class:"whitespace-pre-line"},As={class:"px-2 py-0.5 bg-green-500 text-white rounded-xl text-sm font-semibold"},$s={class:"glass-card rounded-3xl p-6"},Cs={class:"font-normal mb-4"},Ms=["disabled"],Ss={key:1,class:"min-h-[30vh] grid place-items-center"},js={class:"w-full max-w-md mx-auto px-4"},Fs=["innerHTML"],Ts={class:"flex items-center gap-3 mb-4"},Ps={class:"text-xs dark:text-gray-100"},Ds={class:"glass-card rounded-3xl p-4 relative overflow-hidden text-dark dark:text-white"},Bs={class:"font-normal mb-2"},Vs={class:"flex items-stretch gap-0"},Us=["placeholder","disabled"],Ls=["disabled","aria-label"],Zs=G({__name:"CheckoutPage",setup(m){const g=we(),u=Ae(),{showAlert:y}=le(),{locale:$,t:h}=re(),c=N(),A=$e(),b=Ce(),p=oe(),r=ce(),x=Z(""),d=Z("");let _=null;const o=k(()=>!!r.code&&!!r.result&&!r.error&&r.code===d.value),C=k(()=>c.items.length),M=k(()=>{const t=Number(p.options.discount_2||0),s=Number(p.options.discount_3||0);return C.value>=3?s>0?s:0:C.value===2&&t>0?t:0}),F=k(()=>c.subtotalPaid),z=k(()=>F.value*M.value/100),P=k(()=>{var t;return((t=r.result)==null?void 0:t.type)==="discount"?Number(r.result.discount_percent||0):0}),H=k(()=>F.value*P.value/100),W=k(()=>Math.max(0,F.value-z.value-H.value)),B=k(()=>W.value===0&&c.items.length>0),O=k(()=>{const t=Number(p.options.discount_2||0),s=Number(p.options.discount_3||0);return C.value===1?t>0?t:0:C.value===2&&s>0?s:0}),V=t=>"".concat(t.toFixed(2)," ").concat(p.options.currency.toUpperCase()),de=k(()=>{if(!x.value)return[];const t=new Date;return c.items.map(s=>{const a=c.getSubscriptionType(s.id);let l;return a==="trial"?l=me(t,3):l=he(t,1),{id:s.id,name:pe(s,"name"),date:ve(l)}})}),ue=k(()=>c.items.some(t=>c.getSubscriptionType(t.id)==="trial")),pe=(t,s)=>{var a,l,S,E;return(E=(S=(a=t.translations[$.value])==null?void 0:a[s])!=null?S:(l=t.translations.en)==null?void 0:l[s])!=null?E:null},me=(t,s)=>{const a=new Date(t.getTime());return a.setDate(a.getDate()+s),a},he=(t,s)=>{const a=new Date(t.getTime());return a.setMonth(a.getMonth()+s),a},ve=t=>{const s=String(t.getDate()).padStart(2,"0"),a=String(t.getMonth()+1).padStart(2,"0"),l=t.getFullYear();return"".concat(s,".").concat(a,".").concat(l)},ge=k(()=>{const t=[];return c.trialServicesCount>0&&t.push("".concat(c.trialServicesCount," ").concat(h("checkout.trial_services"))),c.premiumServicesCount>0&&t.push("".concat(c.premiumServicesCount," ").concat(h("checkout.premium_services"))),t.join(", ")});Me(()=>{b.stop(),r.code&&r.result&&(d.value=r.code,r.result.type==="free_access"&&c.promoFreeIds.length===0&&c.applyFreeAccessServices(r.result.services||[])),window.addEventListener("pageshow",s=>{const a=performance.getEntriesByType("navigation")[0];(s.persisted||(a==null?void 0:a.type)==="back_forward")&&b.stop()}),document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&b.stop()}),new URLSearchParams(window.location.search).get("success")==="true"&&(c.clearCart(),r.clear(),g.replace({path:"/"}).then(()=>{u.success(h("checkout.success"))}))});const R=async()=>{if(B.value){await ye();return}x.value==="card"?await _e():x.value==="crypto"&&await be()};ie(B,t=>{t&&(x.value="")});const _e=async()=>{var t,s;b.start();try{const a={services:c.items.map(S=>S.id),subscriptionTypes:c.subscriptionTypes,...r.code?{promocode:r.code}:{}},{data:l}=await X.post("/mono/create-payment",a,{headers:{Authorization:"Bearer ".concat(A.token)}});l.url?window.location.href=l.url:(b.stop(),u.error(h("checkout.payment_error")))}catch(a){console.error("Mono payment error:",a);const l=a&&((s=(t=a.response)==null?void 0:t.data)==null?void 0:s.message)||h("checkout.payment_error");u.error(l),b.stop()}},be=async()=>{var t,s;b.start();try{const a={services:c.items.map(S=>S.id),...r.code?{promocode:r.code}:{}},{data:l}=await X.post("/cryptomus/create-payment",a,{headers:{Authorization:"Bearer ".concat(A.token)}});l.url?window.location.href=l.url:(b.stop(),u.error(h("checkout.payment_error")))}catch(a){console.error("Crypto payment error:",a);const l=a&&((s=(t=a.response)==null?void 0:t.data)==null?void 0:s.message)||h("checkout.payment_error");u.error(l),b.stop()}},ye=async()=>{var t,s;try{await c.submitCart({paymentMethod:"free",promocode:r.code||void 0}),await A.fetchUser(),r.clear(),d.value="",u.success(h("checkout.free_success")),await g.push("/")}catch(a){console.error("Free order error:",a);const l=a&&((s=(t=a.response)==null?void 0:t.data)==null?void 0:s.message)||h("checkout.payment_error");u.error(l)}};async function xe(){_&&clearTimeout(_),_=window.setTimeout(async()=>{var t,s;if(await r.apply(d.value),r.error){await y({title:h("alert.title"),text:r.error,icon:"error",confirmText:h("alert.ok")});return}((t=r.result)==null?void 0:t.type)==="free_access"?await c.applyFreeAccessServices(r.result.services||[]):((s=r.result)==null?void 0:s.type)==="discount"&&c.items.length===0&&await y({title:h("alert.title"),text:h("checkout.promocode_discount_empty_cart"),icon:"success",confirmText:h("alert.ok")})},500)}function fe(){r.clear(),c.removeFreeAccessServices(),d.value=""}function Y(){o.value?fe():xe()}return(t,s)=>{const a=Se("i18n-t");return v(),f("div",Ht,[n(c).items.length?(v(),f("div",Wt,[e("div",Ot,[e("h1",Rt,i(t.$t("checkout.title")),1),T(Pe)]),e("div",Yt,[e("form",{class:"space-y-6",onSubmit:U(R,["prevent"])},[T(nt)],32)]),e("div",Et,[e("div",qt,[e("div",Jt,[e("div",Kt,[e("div",Qt,[e("h3",Xt,i(M.value>0||P.value>0?t.$t("checkout.original_total"):t.$t("checkout.total_amount"))+": ",1),e("span",{class:w([M.value>0||P.value>0?"line-through opacity-60":"","font-normal"])},i(V(F.value)),3)]),M.value>0?(v(),f("div",es,[e("span",null,i(t.$t("checkout.discount"))+" ("+i(M.value)+"%)",1),e("span",null,"-"+i(V(z.value)),1)])):j("",!0),P.value>0?(v(),f("div",ts,[e("span",null,i(t.$t("checkout.promocode_discount"))+" ("+i(P.value)+"%)",1),e("span",null,"-"+i(V(H.value)),1)])):j("",!0),M.value>0||P.value>0?(v(),f("div",ss,[e("h3",os,i(t.$t("checkout.total_amount"))+":",1),e("span",rs,i(V(W.value)),1)])):j("",!0)]),e("div",as,[e("div",ns,[J(e("input",{"onUpdate:modelValue":s[0]||(s[0]=l=>d.value=l),placeholder:t.$t("checkout.promocode_placeholder"),class:w(["flex-1 h-11 px-3 border rounded-l-lg rounded-r-none",o.value?"!border-green-400 !bg-green-400/10":"!border-gray-700 dark:!border-gray-300"]),disabled:o.value},null,10,is),[[K,d.value,void 0,{trim:!0}]]),e("button",{class:w(["h-11 w-12 grid place-items-center border border-l-0 rounded-r-lg rounded-l-none transition-all text-white disabled:opacity-50",o.value?"border-red-500 bg-red-500 hover:bg-red-600 dark:border-red-700 dark:bg-red-900 dark:hover:bg-red-800":"border-blue-500 bg-blue-500 hover:bg-blue-600 dark:border-blue-700 dark:bg-blue-900 dark:hover:bg-blue-800"]),disabled:n(r).loading||!o.value&&!d.value,"aria-label":o.value?t.$t("checkout.promocode_clear_aria"):t.$t("checkout.promocode_apply_aria"),onClick:U(Y,["prevent"])},[o.value?(v(),D(n(te),{key:0,class:"w-5 h-5"})):(v(),D(n(ee),{key:1,class:"w-5 h-5"}))],10,ls)])]),e("div",cs,[e("div",ds,[e("div",us,[e("div",ps,[e("p",ms,i(ge.value),1)])])])]),T(Te,{name:"fade",appear:""},{default:L(()=>[x.value!==""?(v(),f("div",hs,[e("div",vs,[e("div",gs,i(t.$t("checkout.next_payments"))+": ",1),T(je,{name:"fade-slide",tag:"ul",class:"text-xs space-y-1 text-dark dark:text-white"},{default:L(()=>[(v(!0),f(ae,null,ne(de.value,(l,S)=>(v(),f("li",{key:l.id,class:"flex items-center gap-2",style:Fe({transitionDelay:"".concat(S*60,"ms")})},[e("span",_s,i(l.name),1),s[3]||(s[3]=e("span",{class:"ml-2"},"—",-1)),e("span",bs,i(l.date),1)],4))),128))]),_:1})])])):j("",!0)]),_:1}),O.value>0?(v(),f("div",ys,[e("div",xs,[e("div",fs,[e("div",ks,[e("div",ws,[T(a,{keypath:"checkout.upsell_generic",tag:"span"},{default:L(()=>s[4]||(s[4]=[e("span",{class:"font-semibold"},"1",-1)])),_:1,__:[4]})])]),e("span",As," -"+i(O.value)+"% ",1)])])])):j("",!0)]),n(r).loading?(v(),D(Q,{key:0,"expand-padding":!0})):j("",!0)]),e("div",$s,[e("h3",Cs,i(t.$t("checkout.payment_method")),1),T(zt,{modelValue:x.value,"onUpdate:modelValue":s[1]||(s[1]=l=>x.value=l),disabled:B.value},null,8,["modelValue","disabled"])]),e("button",{type:"submit",disabled:(B.value?!1:!x.value)||n(c).items.length===0||ue.value&&x.value==="crypto",class:"checkout-btn w-full py-4 rounded-lg font-normal transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed",onClick:U(R,["prevent"])},i(t.$t("checkout.submit")),9,Ms)])])):(v(),f("div",Ss,[e("div",js,[e("p",{class:"text-center dark:text-gray-100 text-xl mt-5 mb-10",innerHTML:t.$t("checkout.empty")},null,8,Fs),e("div",Ts,[s[5]||(s[5]=e("div",{class:"h-px flex-1 bg-gray-500 dark:bg-gray-500"},null,-1)),e("div",Ps,i(t.$t("checkout.promocode_empty_hint")),1),s[6]||(s[6]=e("div",{class:"h-px flex-1 bg-gray-500 dark:bg-gray-500"},null,-1))]),e("div",Ds,[e("h3",Bs,i(t.$t("checkout.title")),1),e("div",Vs,[J(e("input",{"onUpdate:modelValue":s[2]||(s[2]=l=>d.value=l),placeholder:t.$t("checkout.promocode_placeholder"),class:w(["flex-1 h-11 px-3 border rounded-l-lg rounded-r-none",o.value?"!border-green-400 !bg-green-400/10":"!border-gray-700 dark:!border-gray-300"]),disabled:o.value},null,10,Us),[[K,d.value,void 0,{trim:!0}]]),e("button",{class:w(["h-11 w-12 grid place-items-center border border-l-0 rounded-r-lg rounded-l-none transition-all text-white disabled:opacity-50",o.value?"border-red-500 bg-red-500 hover:bg-red-600 dark:border-red-700 dark:bg-red-900 dark:hover:bg-red-800":"border-blue-500 bg-blue-500 hover:bg-blue-600 dark:border-blue-700 dark:bg-blue-900 dark:hover:bg-blue-800"]),disabled:n(r).loading||!o.value&&!d.value,"aria-label":o.value?t.$t("checkout.promocode_clear_aria"):t.$t("checkout.promocode_apply_aria"),onClick:U(Y,["prevent"])},[o.value?(v(),D(n(te),{key:0,class:"w-5 h-5"})):(v(),D(n(ee),{key:1,class:"w-5 h-5"}))],10,Ls)]),n(r).loading?(v(),D(Q,{key:0})):j("",!0)])])]))])}}}),Ws=I(Zs,[["__scopeId","data-v-13ec5a91"]]);export{Ws as default};
