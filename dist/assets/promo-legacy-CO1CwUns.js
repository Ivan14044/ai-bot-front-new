System.register(["./index-legacy-DrOZILrB.js"],function(e,s){"use strict";var t,r;return{setters:[e=>{t=e.P,r=e.Q}],execute:function(){e("usePromoStore",t("promo",{state:()=>({code:"",loading:!1,error:"",result:null,lastAppliedAt:null}),actions:{async apply(e){const s=(e||"").trim();if(s){this.loading=!0,this.error="",this.result=null;try{const{data:e}=await r.post("/promocodes/validate",{code:s});"discount"===(null==e?void 0:e.type)?(this.code=s,this.result={type:"discount",discount_percent:Number(e.discount_percent||0)}):"free_access"===(null==e?void 0:e.type)?(this.code=s,this.result={type:"free_access",services:Array.isArray(e.services)?e.services:[]}):this.error=(null==e?void 0:e.message)||"Invalid promocode",this.lastAppliedAt=Date.now()}catch(i){var t,o;const e=null==i||null===(t=i.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.status,s=null==i||null===(o=i.response)||void 0===o||null===(o=o.data)||void 0===o?void 0:o.message;this.error=s||(e?`Promocode ${e}`:"Invalid promocode")}finally{this.loading=!1}}else this.error=""},clear(){this.code="",this.error="",this.result=null,this.lastAppliedAt=null}},persist:!0}))}}});
