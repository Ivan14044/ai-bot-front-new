import{u as D}from"./ImageWithFallback.vue_vue_type_script_setup_true_lang-UjbA_g2q.js";import{A as R}from"./ArticleCard-BHCqByBH.js";import{d as E,q as O,a1 as W,a as G,u as J,s as o,p as K,D as X,e as u,o as d,f,j as b,g as Y,t as q,F as I,y as T,z as Z,I as ee}from"./index-D06XNq7w.js";import{_ as te}from"./BackLink.vue_vue_type_script_setup_true_lang-DhsFgQHw.js";const ae={class:"max-w-7xl mx-auto px-4 py-16 sm:px-6 lg:px-8 relative"},re={class:"flex items-start justify-between mt-6 mb-10"},se=["innerHTML"],oe={key:0,class:"mt-3 text-gray-600 dark:text-gray-300"},ie=["innerHTML"],ne={key:0},le={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8 xl:gap-6"},de={class:"flex items-center justify-center gap-2 mt-10"},ce=["disabled"],ue=["disabled","onClick"],ge=["disabled"],he=E({__name:"ArticlesAll",setup(me){const{t:w,locale:x}=O(),l=D(),m=W(),s=G(),v=J(),c=o(()=>{var e;return Number((e=s.query.limit)!=null?e:12)}),A=o(()=>{var e;return Number((e=s.query.offset)!=null?e:0)}),_=o(()=>{const e=s.params.page!==void 0?Number(s.params.page):void 0;if(typeof e=="number"&&Number.isFinite(e)&&e>=1)return e;const t=Math.max(1,Number(c.value)||12),a=Math.max(0,Number(A.value)||0);return Math.floor(a/t)+1}),p=o(()=>{const e=Math.max(1,Number(c.value)||12);return(_.value-1)*e}),i=o(()=>{const e=s.params.id!==void 0?Number(s.params.id):void 0;if(typeof e=="number"&&Number.isFinite(e))return e;const t=s.query.category_id!==void 0?Number(s.query.category_id):void 0;if(typeof t=="number"&&Number.isFinite(t))return t});o(()=>{var a,r,n,y;const e=Number((r=(a=l.paginatedParams)==null?void 0:a.offset)!=null?r:0),t=Math.max(1,Number((y=(n=l.paginatedParams)==null?void 0:n.limit)!=null?y:c.value)||12);return Math.floor(e/t)});const L=o(()=>typeof s.params.id<"u"),P=o(()=>typeof i.value=="number"?l.getCategoryById(i.value):void 0),F=o(()=>{var a,r,n;const e=P.value;if(!e)return"";const t=(r=(a=e.translations)==null?void 0:a[x.value])==null?void 0:r.name;return(n=t!=null?t:e.name)!=null?n:""}),U=o(()=>i.value&&F.value||String(w("articles.title"))),N=o(()=>{var n;const e=P.value;if(!e)return"";const t=(n=e.translations)==null?void 0:n[x.value],a=t==null?void 0:t.text;if(typeof a!="string")return"";const r=a.trim();return r.length>0?r:""});K(async()=>{l.hasCachedPage({limit:c.value,offset:p.value,categoryId:i.value})||m.start();try{if(typeof s.query.offset<"u"||typeof s.query.limit<"u"){const t={...s.query};delete t.offset,delete t.limit,delete t.category_id;const a=_.value,r=typeof s.params.id<"u",n=a<=1?r?"/categories/".concat(s.params.id):"/articles":r?"/categories/".concat(s.params.id,"/page/").concat(a):"/articles/page/".concat(a);await v.replace({path:n,query:t})}l.loaded.categories||await l.fetchCategories(),await C(),requestAnimationFrame(()=>{try{if(sessionStorage.getItem("articlesUsedSavedPosition")==="1"){sessionStorage.removeItem("articlesUsedSavedPosition");return}}catch(t){}window.scrollTo({top:0,left:0,behavior:"smooth"})})}finally{m.stop()}}),X([c,p,i],()=>{j()});async function C(){await l.fetchArticlesPage({limit:c.value,offset:p.value,categoryId:i.value})}async function j(){l.hasCachedPage({limit:c.value,offset:p.value,categoryId:i.value})||m.start();try{await C(),requestAnimationFrame(()=>{try{if(sessionStorage.getItem("articlesUsedSavedPosition")==="1"){sessionStorage.removeItem("articlesUsedSavedPosition");return}}catch(t){}window.scrollTo({top:0,left:0,behavior:"smooth"})})}finally{m.stop()}}const $=o(()=>l.getLocalizedPaginatedArticles(x.value)),B=o(()=>l.paginatedTotal),h=o(()=>{const e=Math.max(1,Number(c.value)||12),t=Math.max(0,Number(B.value)||0);return Math.max(1,Math.ceil(t/e))}),k=o(()=>m.isLoading),g=o(()=>{var n,y,M,S;const e=_.value,t=Math.max(1,Number((y=(n=l.paginatedParams)==null?void 0:n.limit)!=null?y:c.value)||12),a=Math.max(0,Number((S=(M=l.paginatedParams)==null?void 0:M.offset)!=null?S:0)||0),r=Math.floor(a/t)+1;return e===r?e:r}),H=o(()=>{const e=h.value,t=g.value;return e<=6?Array.from({length:e},(a,r)=>r+1):t<=3?[1,2,3,"...",e]:t>=e-2?[1,"...",e-2,e-1,e]:[1,"...",t-1,t,t+1,"...",e]});function V(e){if(!Number.isFinite(e)||e<1||e>h.value)return;const t=typeof i.value=="number",a=e<=1?t?"/categories/".concat(i.value):"/articles":t?"/categories/".concat(i.value,"/page/").concat(e):"/articles/page/".concat(e),r={...s.query};delete r.offset,delete r.limit,delete r.category_id,v.push({path:a,query:r})}function Q(){const e=Math.max(1,g.value-1),t=typeof i.value=="number",a=e<=1?t?"/categories/".concat(i.value):"/articles":t?"/categories/".concat(i.value,"/page/").concat(e):"/articles/page/".concat(e),r={...s.query};delete r.offset,delete r.limit,delete r.category_id,v.push({path:a,query:r})}function z(){const e=Math.min(h.value,g.value+1),t=typeof i.value=="number",a=e<=1?t?"/categories/".concat(i.value):"/articles":t?"/categories/".concat(i.value,"/page/").concat(e):"/articles/page/".concat(e),r={...s.query};delete r.offset,delete r.limit,delete r.category_id,v.push({path:a,query:r})}return(e,t)=>(d(),u("div",ae,[f("div",re,[f("div",null,[f("h1",{class:"text-2xl font-medium md:text-4xl md:font-light text-dark dark:text-white",innerHTML:U.value},null,8,se),L.value?N.value?(d(),u("div",{key:1,class:"mt-3 text-gray-600 dark:text-gray-300",innerHTML:N.value},null,8,ie)):b("",!0):(d(),u("p",oe,q(e.$t("articles.description")),1))]),Y(te,{class:"self-start"})]),$.value.length>0?(d(),u("div",ne,[f("div",le,[(d(!0),u(I,null,T($.value,a=>{var r;return d(),Z(R,{key:a.id,title:a.title,excerpt:a.excerpt,categories:a.categories,"image-url":(r=a.img)!=null?r:"/img/no-logo.png",href:"/articles/".concat(a.id),date:a.dateString,short:a.short},null,8,["title","excerpt","categories","image-url","href","date","short"])}),128))]),f("div",de,[g.value>1?(d(),u("button",{key:0,class:"inline-flex items-center justify-center leading-none px-3 py-1.5 rounded border border-gray-300 dark:!border-gray-600/60 text-sm text-gray-700 dark:text-white hover:bg-gray-200 dark:hover:bg-gray-400/30 transition disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-transparent disabled:hover:dark:bg-transparent",disabled:k.value,onClick:Q,"aria-label":"Previous page"}," ← ",8,ce)):b("",!0),(d(!0),u(I,null,T(H.value,a=>(d(),u("button",{key:"p-".concat(a),class:ee(["inline-flex items-center justify-center leading-none px-3 py-1.5 rounded border text-sm transition min-w-[40px] disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-transparent disabled:hover:dark:bg-transparent",[a==="..."?"cursor-default border-transparent text-gray-400":a===g.value?"border-gray-900 bg-gray-900 text-white dark:!bg-gray-300 dark:!text-gray-900 dark:!border-gray-600/60":"border-gray-300 dark:!border-gray-600/60 text-gray-700 dark:!text-white hover:bg-gray-200 dark:hover:bg-gray-400/30"]]),disabled:a==="..."||k.value,onClick:r=>a!=="..."&&V(Number(a))},q(a),11,ue))),128)),g.value<h.value?(d(),u("button",{key:1,class:"inline-flex items-center justify-center leading-none px-3 py-1.5 rounded border border-gray-300 dark:!border-gray-600/60 text-sm text-gray-700 dark:text-white hover:bg-gray-200 dark:hover:bg-gray-400/30 transition disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-transparent disabled:hover:dark:bg-transparent",disabled:k.value,onClick:z,"aria-label":"Next page"}," → ",8,ge)):b("",!0)])])):b("",!0)]))}});export{he as default};
